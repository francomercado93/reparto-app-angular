<form class="container">
  <!-- form-nueva-fila  -->
  <div class="row">
    <div class="col-sm-10">
      <mat-form-field appearance="fill" class="full-width">
        <mat-select placeholder="Seleccionar cliente" [(ngModel)]="nuevaFila.cliente" name="cliente"
          (ngModelChange)="crearCeldas()">
          <mat-option [value]="cliente" *ngFor="let cliente of clientes">
            {{cliente.nombre}}</mat-option>
        </mat-select>
      </mat-form-field>
    </div>
    <div class="col-sm">
      <button mat-raised-button color="accent" class="full-width clean-button" (click)="limpiar()">
        Limpiar
      </button>
    </div>
  </div>
  <div *ngIf="nuevaFila.cliente" class="mt-2 animated fadeIn">
    <div class="row">
      <div class="col-sm" *ngFor="let celda of nuevaFila.celdas">
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Cantidad de {{celda.producto.nombre}}</mat-label>
          <input type="number" matInput placeholder="Cantidad" name="cantidad" [(ngModel)]="celda.cantidad">
          <!-- TODO: se muestra el mismo error para todas las celdas -->
          <!-- #cantidad="ngModel" pattern="^[0-9]+$"> -->
          <!-- <mat-error *ngIf="cantidad.invalid">Debe ingresar una cantidad mayor a cero</mat-error> -->
        </mat-form-field>
      </div>
    </div>
    <div class="row">
      <div class="col-sm">
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Pago</mat-label>
          <input type="number" matInput placeholder="Pago" [(ngModel)]="nuevaFila.pago" name="pago" #pago="ngModel"
            pattern="^[0-9]+$">
          <mat-error *ngIf="pago.invalid">Debe ingresar una cantidad mayor a cero</mat-error>
        </mat-form-field>
      </div>
      <div class="col-sm">
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Observaciones</mat-label>
          <!-- Porque hay que agregar name ? -->
          <input type="number" matInput placeholder="Observaciones" name="observaciones"
            [(ngModel)]="nuevaFila.observaciones">
        </mat-form-field>
      </div>
    </div>

    <div class="row">
      <mat-card class="full-width card-subtotal">
        <mat-card-title color="accent">Subtotal $ {{nuevaFila.subtotal}}</mat-card-title>
      </mat-card>
    </div>
    <div class="row">
      <div class="col button-row">
        <button mat-raised-button color="primary" class="add-button clean-button" (click)="agregarFila()"
          [disabled]="cantidadesSonValidas()">
          Agregar
        </button>
      </div>
    </div>
  </div>
</form>